function detect(){if(PE.isNet()&&3<=PE.getNumberOfSections()&&PE.isNetObjectPresent("SuppressIldasmAttribute")&&PE.isNetObjectPresent("kernel32")&&PE.isNetGlobalCctorPresent()){for(var e="%% %% %% %% %% %% %% %% 00",t=PE.getSize()-PE.getOverlaySize(),r="'<Module>'00",n="00",i=0;i<4;i++){r+=e
for(var s=0;s<2;s++)n+=e}-1==PE.findSignature(0,t,r)&&-1==PE.findSignature(0,t,n)||(sVersion="3.X",bDetected=!0),bDetected&&(PE.findSignature(0,t,generateUnicodeSignatureMask("Program will be terminated."))&&(sOptions="Resources protection"),".vmp"===(t=PE.getSectionNameCollision("0","1"))?sVersion="2.X-3.X":t&&(sOptions+=(0!=sOptions.length?" + ":"")+"Custom sections"),bDetected=bDetected&&!PE.isNetObjectPresent("VMProtect"))}return result()}function generateUnicodeSignatureMask(e){for(var t="",r=0;r<e.length;r++)t+=(0!=r?"00":"")+"'"+e[r]+"'"
return t}meta("protector","VMProtect")
