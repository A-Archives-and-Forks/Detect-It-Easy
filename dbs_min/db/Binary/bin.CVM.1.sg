function detect(){if(!(X.Sz()<2048)&&X.c("'CVMH'")&&isAllZeroes(12,16)&&X.c("'ROFS'",52)){var e=X.SA(68,4)
if(/^[0-9\.]{4}/.test(e)){var s,t,r=X.U64(28,_BE),i=X.U32(128,_BE),a=0,c=!1
if(!(r<12+X.U64(4,_BE))&&isWithin(i,1,12+X.U64(4,_BE)-256>>2)){for(;a<r&&a<X.Sz();){if(s=X.SA(a,4),t=X.U64(a+4,_BE),a+=12,!t||!charStat(s,!0).includes("allasc"))return
switch(s){case"CVMH":case"ZONE":break
default:c=!0}if(c)break
a+=t}return sVersion="v"+e,bDetected=!0,X.isVerbose()?sOption(outSz(r),"sz:"):r<X.Sz()&&(sVersion+="/malformed!short"),result()}}}}meta("format","CRI Middleware's PS2 CVM/ROFS image (.CVM)")
